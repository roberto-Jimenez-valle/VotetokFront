<!doctype html>
<html lang="es">
	<head>
		<meta charset="utf-8" />
		
		<!-- Estilos CR√çTICOS primero - antes que NADA -->
		<style>
			/* MODO CLARO - Estilos aplicados inmediatamente */
			html:not(.dark) {
				background-color: #e8e8e8 !important;
			}
			
			html:not(.dark) body {
				background-color: #e8e8e8 !important;
			}
			
			/* Logo VoteTok - ULTRA ESPEC√çFICO con m√∫ltiples selectores para ganar especificidad */
			html:not(.dark) header h1,
			html:not(.dark) header.top-0 h1,
			html:not(.dark) header h1.text-xl,
			html:not(.dark) header h1.sm\:text-3xl,
			html:not(.dark) header h1.font-extrabold,
			html:not(.dark) h1.tracking-tight,
			html:not(.dark) h1 {
				color: #1a1a1a !important;
				text-shadow: none !important;
			}
			
			/* Sobrescribir el estilo header h1 { color: white } */
			html:not(.dark) header h1 {
				color: #1a1a1a !important;
			}
			
			/* Para ti y tabs */
			html:not(.dark) .tabs-trigger,
			html:not(.dark) .tabs-trigger *,
			html:not(.dark) .tabs-trigger span {
				color: #1a1a1a !important;
			}
			
			html:not(.dark) .tabs-trigger svg,
			html:not(.dark) .tabs-trigger svg * {
				color: #1a1a1a !important;
				fill: #1a1a1a !important;
				stroke: #1a1a1a !important;
			}
		</style>
		
		<!-- Script CR√çTICO: Aplicar tema guardado ANTES de cualquier render -->
		<script>
			(function() {
				try {
					const savedTheme = localStorage.getItem('votetok-theme');
					console.log('[Theme] üöÄ app.html ejecut√°ndose - localStorage raw:', savedTheme);
					
					if (savedTheme) {
						const theme = JSON.parse(savedTheme);
						console.log('[Theme] üöÄ Tema parseado:', theme);
						console.log('[Theme] üîç theme.isDark tipo:', typeof theme.isDark, 'valor:', theme.isDark);
						console.log('[Theme] üîç theme completo:', JSON.stringify(theme));
						
						// IMPORTANTE: Primero remover TODAS las clases, luego aplicar
						document.documentElement.className = '';
						
						// Validaci√≥n ESTRICTA: SOLO agregar .dark si isDark es EXACTAMENTE true
						if (theme.isDark === true) {
							document.documentElement.classList.add('dark');
							console.log('[Theme] ‚úÖ MODO OSCURO - isDark es true - Clase .dark AGREGADA');
						} else if (theme.isDark === false) {
							console.log('[Theme] ‚úÖ MODO CLARO - isDark es false - Clase .dark NO agregada');
						} else {
							// Si no es boolean, convertir
							const isDarkMode = theme.isDark === 'true' || theme.isDark === 1;
							if (isDarkMode) {
								document.documentElement.classList.add('dark');
								console.log('[Theme] ‚ö†Ô∏è MODO OSCURO - isDark era string/number:', theme.isDark);
							} else {
								console.log('[Theme] ‚ö†Ô∏è MODO CLARO - isDark era:', theme.isDark);
							}
						}
						
						console.log('[Theme] üîç Estado FINAL - tiene .dark:', document.documentElement.classList.contains('dark'));
						console.log('[Theme] üîç classList completo:', document.documentElement.classList.toString());
					} else {
						// Sin tema guardado, modo oscuro por defecto
						document.documentElement.classList.add('dark');
						console.log('[Theme] ‚ö™ Sin tema guardado, aplicando OSCURO por defecto');
					}
				} catch (e) {
					// Error, modo oscuro por defecto
					document.documentElement.classList.add('dark');
					console.error('[Theme] ‚ùå Error en app.html:', e);
				}
			})();
		</script>
		
		<link rel="icon" href="%sveltekit.assets%/favicon.png" />
		<link rel="apple-touch-icon" href="/favicon.png" />
		<link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous" />
		
		<!-- Viewport optimizado para iOS y Android -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
		
		<!-- Theme y PWA -->
		<meta name="theme-color" content="#000000" />
		<meta name="application-name" content="VoteTokRed" />
		<meta name="mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		<meta name="apple-mobile-web-app-title" content="VoteTokRed" />
		<meta name="format-detection" content="telephone=no" />
		
		<!-- Estilos cr√≠ticos inline para mejor rendimiento -->
		<style>
			/* Reset y optimizaciones m√≥viles */
			* {
				-webkit-tap-highlight-color: transparent;
				-webkit-touch-callout: none;
			}
			
			/* Variables CSS para altura din√°mica (fix teclado m√≥vil) */
			:root {
				--vh: 1vh;
			}
			
			html, body { 
				-webkit-text-size-adjust: 100%;
				-moz-text-size-adjust: 100%;
				-ms-text-size-adjust: 100%;
				text-size-adjust: 100%;
				overscroll-behavior: none;
				-webkit-overflow-scrolling: touch;
				margin: 0;
				padding: 0;
				background-color: #000000;
				width: 100%;
				height: 100vh;
				height: calc(var(--vh, 1vh) * 100);
			}
			
			/* Optimizaci√≥n de fuentes */
			body {
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
				font-display: swap;
			}
			
		</style>
		
		<!-- Script para calcular vh real (fix teclado m√≥vil) -->
		<script>
			// Calcular altura real del viewport para m√≥viles
			function setVH() {
				const vh = window.innerHeight * 0.01;
				document.documentElement.style.setProperty('--vh', `${vh}px`);
			}
			setVH();
			window.addEventListener('resize', setVH);
			window.addEventListener('orientationchange', setVH);
		</script>
		
		%sveltekit.head%
		
		<!-- Estilos de modo claro - DESPU√âS de sveltekit.head para tener prioridad final -->
		<style>
			/* Variables CSS para colores seg√∫n tema */
			html.dark {
				--logo-color: white;
			}
			
			html:not(.dark) {
				--logo-color: #1a1a1a;
			}
			
			/* Logo negro en modo claro - m√°xima especificidad */
			html:not(.dark) header h1,
			html:not(.dark) header.top-0 h1,
			html:not(.dark) header h1.text-xl,
			html:not(.dark) header h1.sm\:text-3xl,
			html:not(.dark) header h1.font-extrabold,
			html:not(.dark) h1.tracking-tight {
				color: #1a1a1a !important;
			}
			
			/* Para ti negro en modo claro */
			html:not(.dark) .tabs-trigger,
			html:not(.dark) .tabs-trigger * {
				color: #1a1a1a !important;
			}
			
			html:not(.dark) .tabs-trigger svg {
				color: #1a1a1a !important;
				fill: #1a1a1a !important;
			}
		</style>
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">%sveltekit.body%</div>
		<script>
		  if ('serviceWorker' in navigator) {
			window.addEventListener('load', () => {
			  navigator.serviceWorker.register('/sw.js').catch(() => {});
			});
		  }
		</script>
	</body>
</html>
